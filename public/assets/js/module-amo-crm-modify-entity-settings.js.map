{"version":3,"sources":["src/module-amo-crm-modify-entity-settings.js"],"names":["idUrl","idForm","className","ModuleAmoCrmEntityEdit","$formObj","$","$checkBoxes","$dropDowns","$pipelineDropdown","$entityActionDropdown","$typeDropdown","validateRules","initialize","window","checkbox","onChange","onChangeSettings","dropdown","onChangeDropdown","initializeForm","onChangeEntityAction","value","text","$selectedItem","parents","first","show","hide","type","parent","setVisibilityElements","onChangePipelineStatusId","id","undefined","find","attr","pipeLineId","statuses","JSON","parse","val","remove","each","i","item","options","name","selected","append","values","create_contact","create_lead","create_unsorted","entityActionVariants","globalTranslate","cbBeforeSendForm","settings","result","data","form","pipeLineStatuses","cbAfterSendForm","response","console","log","success","title","html","history","pushState","page","location","href","Form","url","origin","globalRootUrl","create_task","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n */\n\nconst idUrl     \t = 'module-amo-crm';\nconst idForm    \t = 'module-amo-crm-entity-settings-form';\nconst className \t = 'ModuleAmoCrmEntityEdit';\n\n/* global $, globalRootUrl, globalTranslate, Form, Config */\nconst ModuleAmoCrmEntityEdit = {\n\t$formObj: \t\t\t\t$('#'+idForm),\n\t$checkBoxes: \t\t\t$('#'+idForm+' .ui.checkbox'),\n\t$dropDowns: \t\t\t$('#'+idForm+' .ui.dropdown'),\n\t$pipelineDropdown:      $('#lead_pipeline_id'),\n\t$entityActionDropdown:  $('#entityAction'),\n\t$typeDropdown:      \t$('#type'),\n\t/**\n\t/**\n\t * Field validation rules\n\t * https://semantic-ui.com/behaviors/form.html\n\t */\n\tvalidateRules: {\n\n\t},\n\n\t/**\n\t * On page load we init some Semantic UI library\n\t */\n\tinitialize() {\n\t\t// инициализируем чекбоксы и выподающие менюшки\n\t\twindow[className].$checkBoxes.checkbox({\n\t\t\tonChange: window[className].onChangeSettings\n\t\t});\n\t\twindow[className].$dropDowns.dropdown({\n\t\t\tonChange: window[className].onChangeDropdown\n\t\t});\n\n\t\twindow[className].onChangeDropdown();\n\t\twindow[className].initializeForm();\n\t},\n\n\tonChangeEntityAction(value, text, $selectedItem) {\n\n\t\t$(\"#responsible\").parents('div.field').first().show();\n\t\t$(\"#def_responsible\").parents('div.field').first().show();\n\n\t\tif('none' === value){\n\t\t\t$('#create_contact').parents('div.checkbox').first().checkbox('set unchecked');\n\t\t\t$('#create_lead').parents('div.checkbox').first().checkbox('set unchecked');\n\t\t\t$('#create_unsorted').parents('div.checkbox').first().checkbox('set unchecked');\n\n\t\t\t$(\"#lead_pipeline_status_id\").parents('div.field').first().hide();\n\t\t\t$(\"#lead_pipeline_id\").parents('div.field').first().hide();\n\n\t\t\t$(\"#responsible\").parents('div.field').first().hide();\n\t\t\t$(\"#def_responsible\").parents('div.field').first().hide();\n\t\t}else if('unsorted' === value){\n\t\t\t$('#create_contact').parents('div.checkbox').first().checkbox('set unchecked');\n\t\t\t$('#create_lead').parents('div.checkbox').first().checkbox('set unchecked');\n\t\t\t$('#create_unsorted').parents('div.checkbox').first().checkbox('set checked');\n\n\t\t\t$(\"#lead_pipeline_status_id\").parents('div.field').first().hide();\n\t\t\t$(\"#lead_pipeline_id\").parents('div.field').first().show();\n\t\t}else if('contact' === value){\n\t\t\t$('#create_contact').parents('div.checkbox').first().checkbox('set checked');\n\t\t\t$('#create_lead').parents('div.checkbox').first().checkbox('set unchecked');\n\t\t\t$('#create_unsorted').parents('div.checkbox').first().checkbox('set unchecked');\n\n\t\t\t$(\"#lead_pipeline_status_id\").parents('div.field').first().hide();\n\t\t\t$(\"#lead_pipeline_id\").parents('div.field').first().hide();\n\t\t}else if('contact_lead'  === value){\n\t\t\t$('#create_contact').parents('div.checkbox').first().checkbox('set checked');\n\t\t\t$('#create_lead').parents('div.checkbox').first().checkbox('set checked');\n\t\t\t$('#create_unsorted').parents('div.checkbox').first().checkbox('set unchecked');\n\n\t\t\t$(\"#lead_pipeline_status_id\").parents('div.field').first().show();\n\t\t\t$(\"#lead_pipeline_id\").parents('div.field').first().show();\n\t\t}else if('lead' === value){\n\t\t\t$('#create_contact').parents('div.checkbox').first().checkbox('set unchecked');\n\t\t\t$('#create_lead').parents('div.checkbox').first().checkbox('set checked');\n\t\t\t$('#create_unsorted').parents('div.checkbox').first().checkbox('set unchecked');\n\n\t\t\t$(\"#lead_pipeline_status_id\").parents('div.field').first().show();\n\t\t\t$(\"#lead_pipeline_id\").parents('div.field').first().show();\n\t\t}\n\n\t\tlet type = window[className].$typeDropdown.parent().dropdown('get value');\n\t\tif(type === 'MISSING_UNKNOWN' || type === 'MISSING_KNOWN'){\n\t\t\t$(\"#responsible\").parents('div.field').first().hide();\n\t\t}\n\t\twindow[className].setVisibilityElements();\n\t},\n\tonChangePipelineStatusId(value, text, $selectedItem) {\n\n\t},\n\tonChangeDropdown(value, text, $selectedItem) {\n\t\tlet id = '';\n\t\tif($selectedItem !== undefined){\n\t\t\tid = $selectedItem.parent().parent().find('select').attr('id');\n\t\t}\n\t\tif( '' === id || id === window[className].$pipelineDropdown.attr('id')){\n\t\t\tlet pipeLineId = window[className].$pipelineDropdown.parent().dropdown('get value');\n\t\t\tlet statuses = JSON.parse($('#pipeLineStatuses').val())[pipeLineId];\n\t\t\t$('#lead_pipeline_status_id').find('option').remove();\n\t\t\t$.each(statuses, function (i, item) {\n\t\t\t\tlet options = {\n\t\t\t\t\tvalue: item.value,\n\t\t\t\t\ttext : item.name\n\t\t\t\t};\n\t\t\t\tif(item.selected){\n\t\t\t\t\toptions.selected = 'selected';\n\t\t\t\t}\n\t\t\t\t$('#lead_pipeline_status_id').append($('<option>', options));\n\t\t\t});\n\t\t\t$('#lead_pipeline_status_id').parent().dropdown({\n\t\t\t\tvalues: statuses,\n\t\t\t\tonChange: window[className].onChangePipelineStatusId\n\t\t\t});\n\t\t}\n\n\t\tif( '' === id || id === window[className].$typeDropdown.attr('id')){\n\t\t\tlet create_contact \t= $('#create_contact').parents('div.checkbox').first().checkbox('is checked');\n\t\t\tlet create_lead \t= $('#create_lead').parents('div.checkbox').first().checkbox('is checked');\n\t\t\tlet create_unsorted\t= $('#create_unsorted').parents('div.checkbox').first().checkbox('is checked');\n\n\t\t\tlet type = window[className].$typeDropdown.parent().dropdown('get value');\n\t\t\tlet entityActionVariants = [];\n\t\t\tif(type === 'INCOMING_UNKNOWN' || type === 'MISSING_UNKNOWN'){\n\t\t\t\tentityActionVariants = [\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_none'], \t\t   \tvalue: 'none', selected: (create_contact===false && create_lead===false && create_unsorted===false)},\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_unsorted'],\t   \tvalue: 'unsorted', selected: (create_unsorted===true)},\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_contact'], \t   \tvalue: 'contact', selected: (create_contact===true && create_lead===false && create_unsorted===false)},\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_contact_lead'], \tvalue: 'contact_lead', selected: (create_contact===true && create_lead===true && create_unsorted===false)},\n\t\t\t\t];\n\t\t\t}else if(type === 'INCOMING_KNOWN' || type === 'MISSING_KNOWN' || type === 'OUTGOING_KNOWN_FAIL' || type === 'OUTGOING_KNOWN'){\n\t\t\t\tentityActionVariants = [\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_none'], \t\t\tvalue: 'none', selected: (create_contact===false && create_lead===false && create_unsorted===false)},\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_lead'], \t\t\tvalue: 'lead', selected: (create_contact===false && create_lead===true && create_unsorted===false)},\n\t\t\t\t];\n\t\t\t}else if(type === 'OUTGOING_UNKNOWN'){\n\t\t\t\tentityActionVariants = [\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_none'], \t\t\tvalue: 'none', selected: (create_contact===false && create_lead===false && create_unsorted===false)},\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_contact'], \t\tvalue: 'contact', selected: (create_contact===true && create_lead===false && create_unsorted===false)},\n\t\t\t\t\t{name: globalTranslate['mod_amo_action_contact_lead'], \tvalue: 'contact_lead', selected: (create_contact===true && create_lead===true && create_unsorted===false)},\n\t\t\t\t];\n\t\t\t}\n\t\t\twindow[className].$entityActionDropdown.find('option').remove();\n\t\t\t$.each(entityActionVariants, function (i, item) {\n\t\t\t\tlet options = {\n\t\t\t\t\tvalue: item.value,\n\t\t\t\t\ttext : item.name\n\t\t\t\t};\n\t\t\t\tif(item.selected){\n\t\t\t\t\toptions.selected = 'selected';\n\t\t\t\t}\n\t\t\t\twindow[className].$entityActionDropdown.append($('<option>', options));\n\t\t\t});\n\t\t\twindow[className].$entityActionDropdown.parent().dropdown({\n\t\t\t\tvalues: entityActionVariants,\n\t\t\t\tonChange: window[className].onChangeEntityAction\n\t\t\t});\n\t\t}\n\t\twindow[className].setVisibilityElements();\n\t},\n\n\t/**\n\t *\n\t */\n\tonChangeSettings(){\n\t\twindow[className].setVisibilityElements();\n\t},\n\n\t/**\n\t * We can modify some data before form send\n\t * @param settings\n\t * @returns {*}\n\t */\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = window[className].$formObj.form('get values');\n\t\tdelete result.data.pipeLineStatuses;\n\t\treturn result;\n\t},\n\t/**\n\t * Some actions after forms send\n\t */\n\tcbAfterSendForm(response) {\n\t\tconsole.log(response);\n\t\tif(response.success === true && $('#id').val() === ''){\n\t\t\t$('#id').val(response.id);\n\t\t\tlet title = $('head title').html();\n\t\t\twindow.history.pushState({page: title}, title, `${window.location.href}${response.id}`);\n\t\t}\n\t},\n\n\t/**\n\t * Initialize form parameters\n\t */\n\tinitializeForm() {\n\t\tForm.$formObj = window[className].$formObj;\n\t\tForm.url = `${window.location.origin}${globalRootUrl}${idUrl}/saveEntitySettings`;\n\t\tForm.validateRules = window[className].validateRules;\n\t\tForm.cbBeforeSendForm = window[className].cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = window[className].cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n\n\tsetVisibilityElements(){\n\t\tlet create_contact  = $('#create_contact').parents('div.checkbox').checkbox('is checked');\n\t\tlet create_unsorted\t= $('#create_unsorted').parents('div.checkbox').first().checkbox('is checked');\n\t\tif(create_contact || create_unsorted){\n\t\t\t$('#template_contact_name').parents('div.field').first().show();\n\t\t}else{\n\t\t\t$('#template_contact_name').parents('div.field').first().hide();\n\t\t}\n\t\tlet create_lead \t= $('#create_lead').parents('div.checkbox').checkbox('is checked');\n\t\tif(create_lead || create_unsorted){\n\t\t\t$('#template_lead_name').parents('div.field').first().show();\n\t\t}else{\n\t\t\t$('#template_lead_name').parents('div.field').first().hide();\n\t\t}\n\t\tlet create_task\t\t= $('#create_task').parents('div.checkbox').checkbox('is checked');\n\t\tif(create_task){\n\t\t\t$('#template_task_text').parents('div.field').first().show();\n\t\t\t$('#deadline_task').parents('div.field').first().show();\n\t\t}else{\n\t\t\t$('#template_task_text').parents('div.field').first().hide();\n\t\t\t$('#deadline_task').parents('div.field').first().hide();\n\t\t}\n\t}\n};\n\n$(document).ready(() => {\n\twindow[className].initialize();\n});\n\n"],"file":"module-amo-crm-modify-entity-settings.js"}